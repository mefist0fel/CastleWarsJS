<html>
	<head>
		<title>Elements prot</title>
		<style type="text/css">
		body {
			display: block;
			background-color:0;
			width: 100%;
			height: 100%;
			margin: 0;
		}
		canvas {
			background-color:#ffffff;
			display: block;
			margin: 0px auto;
		}
		</style>
	</head>
	<body>
		<canvas id="tutorial"></canvas>
	</body>
	<script type="text/javascript">
	function d(b,a){return[b[0]+a[0],b[1]+a[1],b[2]+a[2]]}function g(b,a){return[b[0]-a[0],b[1]-a[1],b[2]-a[2]]}function aa(b,a){return Math.sqrt((b[0]-a[0])*(b[0]-a[0])+(b[1]-a[1])*(b[1]-a[1]))}function ba(b){var a=1/aa(b,[0,0,0]);0>=a&&(a=1E-10);Infinity==a&&(a=1E13);-Infinity==a&&(a=-1E13);return h(b,a)}function h(b,a){return[b[0]*a,b[1]*a,b[2]*a]}function r(b){var a=newCoord;return a[0]>=b[0]&&a[0]<=b[2]&&a[1]>=b[1]&&a[1]<=b[3]}
function ca(b,a,c){return[Math.sin(a/180*3.14)*b,Math.cos(a/180*3.14)*b*c]}function s(b){b=g(b,u.position);return[b[0]*u.G[0][0]+b[1]*u.G[1][0]+.5*da,b[0]*u.G[0][1]+b[1]*u.G[1][1]+.5*ea-b[2]*u.height]}function v(b){x.beginPath();var a=s(b[0]);x.moveTo(a[0],a[1]);for(var c=1;c<b.length;c++)a=s(b[c]),x.lineTo(a[0],a[1]);x.closePath();x.fill();x.stroke()}
function fa(){this.N=function(b){for(var a=0;24>a;a++)this[String.fromCharCode(97+a)]=b[a]||0;.01>this.c&&(this.c=.01);b=this.b+this.c+this.e;.18>b&&(b=.18/b,this.b*=b,this.c*=b,this.e*=b)}}
var ma=new function(){this.J=new fa;var b,a,c,n,m,e,k,f,q,D,z,pa;this.reset=function(){var a=this.J;n=100/(a.f*a.f+.001);m=100/(a.g*a.g+.001);e=1-a.h*a.h*a.h*.01;k=-a.i*a.i*a.i*1E-6;a.a||(z=.5-a.n/2,pa=5E-5*-a.o);f=1+a.l*a.l*(0<a.l?-.9:10);q=0;D=1==a.m?0:(1-a.m)*(1-a.m)*2E4+32};this.P=function(){this.reset();var e=this.J;b=e.b*e.b*1E5;a=e.c*e.c*1E5;c=e.e*e.e*1E5+12;return 3*((b+a+c)/3|0)};this.O=function(Ea,qa){var l=this.J,ra=1!=l.s||l.v,E=l.v*l.v*.1,sa=1+3E-4*l.w,A=l.s*l.s*l.s*.1,Fa=1+1E-4*l.t,
Ga=1!=l.s,Ha=l.x*l.x,Ia=l.g,ta=l.q||l.r,Ja=l.r*l.r*l.r*.2,ga=l.q*l.q*(0>l.q?-1020:1020),ua=l.p?((1-l.p)*(1-l.p)*2E4|0)+32:0,Ka=l.d,va=l.j/2,La=l.k*l.k*.01,ha=l.a,ia=b,Ma=1/b,Na=1/a,Oa=1/c,l=5/(1+l.u*l.u*20)*(.01+A);.8<l&&(l=.8);for(var l=1-l,ja=!1,wa=0,N=0,O=0,W=0,J=0,P,K=0,t,B=0,F,ka=0,p,xa=0,C,la=0,X=Array(1024),Q=Array(32),w=X.length;w--;)X[w]=0;for(w=Q.length;w--;)Q[w]=2*Math.random()-1;for(w=0;w<qa;w++){if(ja)return w;ua&&++xa>=ua&&(xa=0,this.reset());D&&++q>=D&&(D=0,n*=f);e+=k;n*=e;n>m&&(n=
m,0<Ia&&(ja=!0));t=n;0<va&&(la+=La,t*=1+Math.sin(la)*va);t|=0;8>t&&(t=8);ha||(z+=pa,0>z?z=0:.5<z&&(z=.5));if(++N>ia)switch(N=0,++wa){case 1:ia=a;break;case 2:ia=c}switch(wa){case 0:O=N*Ma;break;case 1:O=1+2*(1-N*Na)*Ka;break;case 2:O=1-N*Oa;break;case 3:O=0,ja=!0}ta&&(ga+=Ja,F=ga|0,0>F?F=-F:1023<F&&(F=1023));ra&&sa&&(E*=sa,1E-5>E?E=1E-5:.1<E&&(E=.1));C=0;for(var Pa=8;Pa--;){B++;if(B>=t&&(B%=t,3==ha))for(P=Q.length;P--;)Q[P]=2*Math.random()-1;switch(ha){case 0:p=B/t<z?.5:-.5;break;case 1:p=1-B/t*2;
break;case 2:p=B/t;p=6.28318531*(.5<p?p-1:p);p=1.27323954*p+.405284735*p*p*(0>p?1:-1);p=.225*((0>p?-1:1)*p*p-p)+p;break;case 3:p=Q[Math.abs(32*B/t|0)]}ra&&(P=K,A*=Fa,0>A?A=0:.1<A&&(A=.1),Ga?(J+=(p-K)*A,J*=l):(K=p,J=0),K+=J,W+=K-P,p=W*=1-E);ta&&(X[ka%1024]=p,p+=X[(ka-F+1024)%1024],ka++);C+=p}C=.125*C*O*Ha;Ea[w]=1<=C?32767:-1>=C?-32768:32767*C|0}return qa}};
window.jsfxr=function(b){ma.J.N(b);var a=ma.P();b=new Uint8Array(4*((a+1)/2|0)+44);var a=2*ma.O(new Uint16Array(b.buffer,44),a),c=new Uint32Array(b.buffer,0,44);c[0]=1179011410;c[1]=a+36;c[2]=1163280727;c[3]=544501094;c[4]=16;c[5]=65537;c[6]=44100;c[7]=88200;c[8]=1048578;c[9]=1635017060;c[10]=a;for(var a=a+44,c=0,n="data:audio/wav;base64,";c<a;c+=3)var m=b[c]<<16|b[c+1]<<8|b[c+2],n=n+("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m>>18]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m>>
12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m&63]);return n};var na=window.URL||window.webkitURL;
function oa(){var b=[0,,.1812,,.1349,.4524,,.2365,,,,,,.0819,,,,,1,,,,,.5];try{var a=jsfxr(b),c=new Audio;c.addEventListener("error",function(){console.log("Error: "+c.error.code)},!1);c.src=a;c.play();c.addEventListener("ended",function(){na.revokeObjectURL(a)},!1)}catch(n){console.log(n.message)}}
var y=[1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,2,1,0,0,1,0,0,0,1,1,0,0,1,0,0,1,3,2,1,1,0,0,0,1,1,1,0,1,,,,1,1,1,1,1,1,,,,,,1,1,1,,,,1,,,,,,,,1,,,,,,,,,,1,,,,,,,,1,,,,,,,1,1,1,0,0,0,0,0,1,1,1,0,0,0,1,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,2,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,3,1,1,0,0,1,0,0,0,1,1,0,0,1,0,0,3,3,2,0,1,0,0,0,1,1,1,0,1,0,0,0,4,3,2,1,1,1,0,0,0,0,0,1,1,1,0,0,4,3,2,0,0,0,0,0,0,1,0,0,0,0,0,0,6,3,3,1,0,0,0,0,0,0,0,1,0,0,0,0,5,3,3,2,1,1,0,0,0,0,1,1,1,0,0,0,4,3,3,2,0,1,0,
0,0,0,0,1,0,0,0,0],ya,G=0,Aa=za(),H=1/30,da=1024,ea=768;function Ba(){return{H:!1,position:[0,0,0],B:[0,0,0],K:100,A:.2}}var I=document.getElementById("tutorial"),x=I.getContext("2d");I.width=da;I.height=ea;rect=I.getBoundingClientRect();
var L=function(b){for(var a={key:[200],L:!1,M:[0,0]},c=0;200>c;c++)a.key[c]=!1;document.addEventListener("keydown",function(b){a.key[b.keyCode]=!0},!1);document.addEventListener("keyup",function(b){a.key[b.keyCode]=!1},!1);document.addEventListener("click",function(){},!1);document.addEventListener("mousedown",function(){a.L=!0},!1);document.addEventListener("mouseup",function(){a.L=!1},!1);document.addEventListener("mousemove",function(c){a.M[0]=c.clientX-b.left;a.M[1]=c.clientY-b.top},!1);document.addEventListener("touchstart",
function(){},!1);document.addEventListener("touchmove",function(){},!1);return a}(rect,I),u=function(){var b={position:[0,0,0],C:42,D:1.6/3,G:[[70,40],[40,-70]],height:50,I:70,F:function(a){this.I=a;this.G[0]=ca(a,this.C-90,this.D);this.G[1]=ca(a,this.C,this.D)}};b.F(70);return b}(),M=Ba(),R=!1;M.position=[3.5,3.5,2];var Ca=.3,S=0,T=[];function U(b){return[1.8*Math.sin(b/180*3.14),1.8*Math.cos(b/180*3.14),0]}function V(){T=[U(u.C+180),U(u.C+0),U(u.C+90),U(u.C+270)]}V();
for(var Y=[200],Z=0;200>Z;Z++)Y[Z]=Ba();function za(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}function $(b){return"rgba("+b+","+b+","+b+",1)"}function Da(b,a){coordA=s(b);coordB=s(a);return coordA[0]<coordB[0]}for(var Qa=[16],Z=0;16>Z;Z++)Qa[Z]=[Math.cos(22*Z/180*3.14),Math.sin(22*Z/180*3.14)];
function Ra(){ya=za();G+=Math.min(1,(ya-Aa)/1E3);G>H&&(G=H);S+=H;1.8<S&&(S=0);Ca=.06*Math.sin(S/1.8*6.28)+.4;M.B=[0,0,M.B[2]];if(L.key[38]||L.key[87])M.B=d(M.B,T[0]);if(L.key[40]||L.key[83])M.B=d(M.B,T[1]);if(L.key[37]||L.key[65])M.B=d(M.B,T[2]);if(L.key[39]||L.key[68])M.B=d(M.B,T[3]);L.key[32]&&R&&(M.B=d(M.B,[0,0,3]),R=!1,oa());L.key[69]&&(u.C+=1,u.F(70),V());L.key[81]&&(u.C-=1,u.F(70),V());L.key[67]&&(u.D+=.01,1<=u.D&&(u.D=1),u.F(70),V());L.key[86]&&(u.D-=.01,-1>=u.D&&(u.D=-1),u.F(70),V());L.key[88]&&
(u.height+=.5,100<=u.height&&(u.height=100),u.F(70),V());L.key[90]&&(u.height-=.5,5>=u.height&&(u.height=5),u.F(70),V());if(L.L)for(var b=M.position,a=ba(g(L.M,M.position)),c=0;200>c;c++)if(!Y[c].H){Y[c].H=!0;Y[c].position=b;Y[c].B=h(d(a,[.1*Math.random()-.05,.1*Math.random()-.05,0]),400);Y[c].K=3;break}M.B[2]-=3*H;newCoord=d(M.position,h(M.B,H));b=[Math.floor(M.position[0]),Math.floor(M.position[1])];for(a=Math.max(0,b[0]-1);a<=b[0]+1&&16>a;a++)for(c=Math.max(0,b[1]-1);c<=b[1]+1&&16>c;c++)if(0<y[16*
a+c]){for(var n=.5*y[16*a+c],m=[0,0,0],e=!1,k=[[a,c,0],[a+1,c,0],[a+1,c+1,0],[a,c+1,0]],f=0;4>f;f++){var q=aa(newCoord,k[f]);q<=M.A&&(m=ba(g(k[f],newCoord)),m[2]=0,m=h(m,q-M.A),e=!0)}r([a-M.A,c,a+1+M.A,c+1])&&(m[1]=0,e=!0,m[0]=newCoord[0]<a+.5?a-M.A-newCoord[0]:a+1+M.A-newCoord[0]);r([a,c-M.A,a+1,c+1+M.A])&&(m[0]=0,e=!0,m[1]=newCoord[1]<c+.5?c-M.A-newCoord[1]:c+1+M.A-newCoord[1]);e&&n>=newCoord[2]&&n<=M.position[2]&&(M.B[2]=0,R=!0,newCoord[2]=n)}for(a=Math.max(0,b[0]-1);a<=b[0]+1&&16>a;a++)for(c=
Math.max(0,b[1]-1);c<=b[1]+1&&16>c;c++)if(0<y[16*a+c]){n=.5*y[16*a+c];m=[0,0,0];e=!1;k=[[a,c,0],[a+1,c,0],[a+1,c+1,0],[a,c+1,0]];for(f=0;4>f;f++)q=aa(newCoord,k[f]),q<=M.A&&(m=ba(g(k[f],newCoord)),m[2]=0,m=h(m,q-M.A),e=!0);r([a-M.A,c,a+1+M.A,c+1])&&(m[1]=0,e=!0,collideH=n,m[0]=newCoord[0]<a+.5?a-M.A-newCoord[0]:a+1+M.A-newCoord[0]);r([a,c-M.A,a+1,c+1+M.A])&&(m[0]=0,e=!0,m[1]=newCoord[1]<c+.5?c-M.A-newCoord[1]:c+1+M.A-newCoord[1]);e&&n>newCoord[2]&&(newCoord=d(newCoord,m))}-5>newCoord[2]&&(M.B[2]=
0,newCoord=[3.5,3.5,2],R=!0);M.position=newCoord;for(a=0;200>a;a++)Y[a].H&&(Y[a].position=d(Y[a].position,h(Y[a].B,H)),Y[a].K-=H,0>Y[a].K&&(Y[a].H=!1));u.position=d(h(u.position,.9),h(d(M.position,[0,0,-.4]),.1));x.fillStyle="#000000";x.fillRect(0,0,da,ea);b=[Math.floor(M.position[0]),Math.floor(M.position[1])];180<u.C?.5*y[16*Math.floor(M.position[0]-M.A)+Math.floor(M.position[1])]<=M.position[2]&&(b[0]-=1):.5*y[16*Math.floor(M.position[0]+M.A)+Math.floor(M.position[1])]<=M.position[2]&&(b[0]+=1);
90<u.C&&270>u.C?.5*y[16*Math.floor(M.position[0])+Math.floor(M.position[1]-M.A)]<=M.position[2]&&(b[1]-=1):.5*y[16*Math.floor(M.position[0])+Math.floor(M.position[1]+M.A)]<=M.position[2]&&(b[1]+=1);for(a=0;16>a;a++)for(c=0;16>c;c++){n=a;m=c;180<u.C&&(n=15-a);90<u.C&&270>u.C&&(m=15-c);if(0<y[16*n+m]&&(e=n,f=m,k=.5*y[16*n+m],q=-.34*((n%3+m%5)%7+1),Da([e+1,f,k],[e+1,f+1,k])&&(x.fillStyle=$(180+(e+f)%2*20-(e+f)%3*8),x.strokeStyle=x.fillStyle,v([[e+1,f,k],[e+1,f+1,k],[e+1,f+1,q],[e+1,f,q]])),Da([e+1,f+
1,k],[e,f+1,k])&&(x.fillStyle=$(160+(e+f)%2*20-(e+f)%3*8),x.strokeStyle=x.fillStyle,v([[e+1,f+1,k],[e,f+1,k],[e,f+1,q],[e+1,f+1,q]])),Da([e,f+1,k],[e,f,k])&&(x.fillStyle=$(180+(e+f)%2*20-(e+f)%3*8),x.strokeStyle=x.fillStyle,v([[e,f+1,k],[e,f,k],[e,f,q],[e,f+1,q]])),Da([e,f,k],[e+1,f,k])&&(x.fillStyle=$(160+(e+f)%2*20-(e+f)%3*8),x.strokeStyle=x.fillStyle,v([[e,f,k],[e+1,f,k],[e+1,f,q],[e,f,q]])),x.fillStyle=.5<(e+f)%2?$(240+10*k):$(230+10*k),x.strokeStyle=x.fillStyle,v([[e,f,k],[e+1,f,k],[e+1,f+1,
k],[e,f+1,k]]),!(0>k)&&(k=Math.floor(M.position[0]-.5),q=Math.floor(M.position[1]-.5),!(e!=k&&e!=k+1||f!=q&&f!=q+1)&&(x.fillStyle="rgba(0,0,0,0.2)",x.strokeStyle="rgba(0,0,0,0.0)",e=[e,f],0<y[16*e[0]+e[1]])))){for(var f=.5*y[16*e[0]+e[1]],q=M.A*(1-.14*Math.max(0,M.position[2]-f)),D=[8],k=0;k<Qa.length;k++)D[k]=[Math.max(e[0],Math.min(e[0]+1,M.position[0]+Qa[k][0]*q)),Math.max(e[1],Math.min(e[1]+1,M.position[1]+Qa[k][1]*q)),f];v(D);x.fill()}b[0]==n&&b[1]==m&&(x.fillStyle="#FF0000",x.beginPath(),n=
s(d(M.position,[0,0,Ca])),x.arc(n[0],n[1],M.A*u.I,0,2*Math.PI),x.closePath(),x.fill(),x.fillStyle="#FFFFFF",x.beginPath(),x.arc(n[0]+.3*M.A*u.I,n[1]-.3*M.A*u.I,.2*M.A*u.I,0,2*Math.PI),x.closePath(),x.fill())}for(a=0;200>a;a++)Y[a].H&&x.fillRect(Y[a].position[0]-1,Y[a].position[1]-1,2,2);x.font="14pt Arial";x.fillText("Q / E - Rotate level",10,30);x.fillText("Z / X - change height constant",10,50);x.fillText("C / V - change tile aspect",10,70);x.fillText("Camera angle "+u.C,10,90);Aa=ya;requestAnimationFrame(Ra)}
requestAnimationFrame(Ra);


	</script>
</html>