<html>
	<head>
		<title>Castles</title>
		<style type="text/css">
		body {
			display: block;
			background-color:0;
			width: 100%;
			height: 100%;
			margin: 0;
		}
		canvas {
			background-color:0;
			display: block;
			margin: 0px auto;
		}
		</style>
	</head>
	<body>
		<canvas id="a"></canvas>
	</body>
	<script type="text/javascript">
function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function ba(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if(b)return b.call(a);if("number"==typeof a.length)return{next:aa(a)};throw Error(String(a)+" is not an iterable or ArrayLike");}function ca(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}function da(a,b){return[a[0]+b[0],a[1]+b[1]]}
function ja(a,b){return Math.sqrt((a[0]-b[0])*(a[0]-b[0])+(a[1]-b[1])*(a[1]-b[1]))}function n(a,b){return[a[0]*b,a[1]*b,a[2]*b]}function q(a,b){ka.addEventListener(a,b,!1)}function la(){this.Y=function(a){for(var b=0;24>b;b++)this[String.fromCharCode(97+b)]=a[b]||0;.01>this.c&&(this.c=.01);a=this.b+this.c+this.e;.18>a&&(a=.18/a,this.b*=a,this.c*=a,this.e*=a)}}
var ma=new function(){this.I=new la;var a,b,c,e,d,h,u,k,f,r,p,oa;this.reset=function(){var l=this.I;e=100/(l.f*l.f+.001);d=100/(l.g*l.g+.001);h=1-l.h*l.h*l.h*.01;u=-l.i*l.i*l.i*1E-6;l.a||(p=.5-l.n/2,oa=5E-5*-l.o);k=1+l.l*l.l*(0<l.l?-.9:10);f=0;r=1==l.m?0:(1-l.m)*(1-l.m)*2E4+32};this.$=function(){this.reset();var l=this.I;a=l.b*l.b*1E5;b=l.c*l.c*1E5;c=l.e*l.e*1E5+12;return 3*((a+b+c)/3|0)};this.Z=function(l,pa){var g=this.I,qa=1!=g.s||g.v,J=g.v*g.v*.1,ra=1+3E-4*g.w,E=g.s*g.s*g.s*.1,Ra=1+1E-4*g.t,Sa=
1!=g.s,Ta=g.x*g.x,Ua=g.g,sa=g.q||g.r,Va=g.r*g.r*g.r*.2,ta=g.q*g.q*(0>g.q?-1020:1020),ua=g.p?((1-g.p)*(1-g.p)*2E4|0)+32:0,Wa=g.d,va=g.j/2,Xa=g.k*g.k*.01,ea=g.a,fa=a,Ya=1/a,Za=1/b,$a=1/c;g=5/(1+g.u*g.u*20)*(.01+E);.8<g&&(g=.8);g=1-g;for(var ha=!1,wa=0,M=0,N=0,xa=0,V=0,O,P=0,v,F=0,G,ia=0,m,ya=0,K,za=0,W=Array(1024),Q=Array(32),y=W.length;y--;)W[y]=0;for(y=Q.length;y--;)Q[y]=2*Math.random()-1;for(y=0;y<pa;y++){if(ha)return y;ua&&++ya>=ua&&(ya=0,this.reset());r&&++f>=r&&(r=0,e*=k);h+=u;e*=h;e>d&&(e=d,
0<Ua&&(ha=!0));v=e;0<va&&(za+=Xa,v*=1+Math.sin(za)*va);v|=0;8>v&&(v=8);ea||(p+=oa,0>p?p=0:.5<p&&(p=.5));if(++M>fa)switch(M=0,++wa){case 1:fa=b;break;case 2:fa=c}switch(wa){case 0:N=M*Ya;break;case 1:N=1+2*(1-M*Za)*Wa;break;case 2:N=1-M*$a;break;case 3:N=0,ha=!0}sa&&(ta+=Va,G=ta|0,0>G?G=-G:1023<G&&(G=1023));qa&&ra&&(J*=ra,1E-5>J?J=1E-5:.1<J&&(J=.1));K=0;for(var ab=8;ab--;){F++;if(F>=v&&(F%=v,3==ea))for(O=Q.length;O--;)Q[O]=2*Math.random()-1;switch(ea){case 0:m=F/v<p?.5:-.5;break;case 1:m=1-F/v*2;break;
case 2:m=F/v;m=6.28318531*(.5<m?m-1:m);m=1.27323954*m+.405284735*m*m*(0>m?1:-1);m=.225*((0>m?-1:1)*m*m-m)+m;break;case 3:m=Q[Math.abs(32*F/v|0)]}qa&&(O=P,E*=Ra,0>E?E=0:.1<E&&(E=.1),Sa?(V+=(m-P)*E,V*=g):(P=m,V=0),P+=V,xa+=P-O,m=xa*=1-J);sa&&(W[ia%1024]=m,m+=W[(ia-G+1024)%1024],ia++);K+=m}K*=.125*N*Ta;l[y]=1<=K?32767:-1>=K?-32768:32767*K|0}return pa}};
window.jsfxr=function(a){ma.I.Y(a);var b=ma.$();a=new Uint8Array(4*((b+1)/2|0)+44);b=2*ma.Z(new Uint16Array(a.buffer,44),b);var c=new Uint32Array(a.buffer,0,44);c[0]=1179011410;c[1]=b+36;c[2]=1163280727;c[3]=544501094;c[4]=16;c[5]=65537;c[6]=44100;c[7]=88200;c[8]=1048578;c[9]=1635017060;c[10]=b;b+=44;c=0;for(var e="data:audio/wav;base64,";c<b;c+=3){var d=a[c]<<16|a[c+1]<<8|a[c+2];e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>18]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>
12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d&63]}return e};var na=[],Aa=[1,0],Ba=[0,1],Ca=[0,.5],Da=0;for(t=0;100>t;t++)for(w=0;100>w;w++)na.push(3*Math.random());
function Ea(){var a=t-50,b=w-50,c=na[t+100*w];x.beginPath();var e=z(a-.5,b-.5,c),d=z(a-.5,b+.5,c),h=z(a+.5,b+.5,c);a=z(a+.5,b-.5,c);x.moveTo(a[0]*A*3+B,a[1]*A*3+C);x.lineTo(e[0]*A*3+B,e[1]*A*3+C);x.lineTo(d[0]*A*3+B,d[1]*A*3+C);x.lineTo(h[0]*A*3+B,h[1]*A*3+C);x.lineTo(a[0]*A*3+B,a[1]*A*3+C);x.closePath();x.fill();x.stroke()}function z(a,b,c){return da(da(n(Aa,a),n(Ba,b)),n(Ca,c))}function Fa(a){return[Math.cos(3.1415*a),.6*Math.sin(3.1415*a)]}var D=[];
function Ga(a,b,c,e){var d=[1,2,3],h=[1,2,3],u=[15,20,999],k={A:[a,b],C:void 0===c?-1:c,L:0,T:null,target:null,level:void 0===e?0:e,B:10,max:100,K:1,H:0,S:[],G:0,F:null,R:function(){x.fillStyle=Ha(k.C);var f=d[this.level];H(k.A[0]-f,k.A[1]-f,f+f,f+f);x.textAlign="center";x.fillText(k.B,k.A[0]*A+B,(k.A[1]-f-1)*A+C);k.B>=u[k.level]&&H(k.A[0]+f+f,k.A[1]-f-f-1,1,1)},V:function(){x.fillStyle="#FFFFFF";var f=d[this.level]+1;H(k.A[0]-f,k.A[1]-f,f+f,f+f);x.fillStyle="#FF00FF";D.forEach(function(r){if(null!=
r.F){var p=d[r.level]+1;H(r.A[0]-p,r.A[1]-p,p+p,p+p)}})},upgrade:function(){this.B>=u[k.level]&&(this.B-=u[k.level],this.level+=1)},update:function(f){this.K-=f;0>=this.K&&(this.K=1,0<=this.C&&k.B<k.max&&(this.B+=h[this.level]));0<this.H?this.H-=f:0<this.B&&0<this.L?(--this.B,--this.L,Ia(this.A[0],this.A[1],this.C,this.T),this.H+=.2):this.target=null},contains:function(f,r){var p=k.A;return p[0]-3<f&&p[1]-3<r&&p[0]+3>f&&p[1]+3>r},attack:function(f){this.C==f?this.B+=1:0>=this.B?(this.C=f,this.B=1):
--this.B},X:function(f){if(null!=f&&null!=f.F){this.target=f;this.L=this.B/2;var r=[];for(r.push(f);null!=f.F;)f=f.F,r.push(f);this.T=r}}};I.push(k);L.push(k);D.push(k)}function Ha(a){switch(a){case 0:return"#0000FF";case 1:return"#FF0000";case 2:return"#00FF00";default:return"#555555"}}function Ja(){var a=R.O,b=(a[0]-B)/A;a=(a[1]-C)/A;for(var c=0;c<D.length;c++)if(D[c].contains(b,a))return D[c];return null}
function Ka(){var a=S;D.forEach(function(e){e.G=99999;e.F=null});if(null!=a){var b=[];b.push(a);a.G=0;for(var c={};0<b.length;)c={D:c.D},c.D=b.pop(),c.D.S.forEach(function(e){return function(d){var h=e.D.G+ja(e.D.A,d.A);d.G>h&&(d.G=h,d.F=e.D,d.C==a.C&&b.push(d))}}(c))}}var La=[0,0];
function Ia(a,b,c,e){var d={A:[a,b],U:La,J:0,C:c,target:null,path:[].concat(e instanceof Array?e:ca(ba(e))),B:1,R:function(h){h.fillStyle=Ha(d.C);H(d.A[0]-1,d.A[1]-1,2,2)},update:function(h){d.A=da(d.A,n(d.U,h));d.J-=h;if(0>=d.J)if(0<d.path.length){d.target=d.path.pop();h=d.target.A;var u=d.A;h=[h[0]-u[0],h[1]-u[1]];u=Math.sqrt(h[0]*h[0]+h[1]*h[1]);var k=1/Math.sqrt(h[0]*h[0]+h[1]*h[1]);0>=k&&(k=1E-10);Infinity==k&&(k=Number.MAX_VALUE);-Infinity==k&&(k=Number.MIN_VALUE);d.U=n(n(h,k),10);d.J=u/10}else d.target.attack(d.C),
h=I.indexOf(d),-1<h&&I.splice(h,1),h=L.indexOf(d),-1<h&&L.splice(h,1)}};I.push(d);L.push(d)}var Ma,T=0,Oa=Na(),Pa=1/30,ka=document,Qa=ka.getElementById("a"),x=Qa.getContext("2d"),U=1,X=1,bb=1,B=1,C=1,A=1,cb=ka.documentElement;db();var eb=Qa.getBoundingClientRect(),S=null,I=[],L=[];Ga(-40,0,0,2);Ga(40,0,1,2);for(var t=-1;2>t;t++)for(var w=-1;2>w;w++)Ga(20*t,20*w);for(var Y=0;Y<D.length;Y++)for(var Z=0;Z<D.length;Z++)Y!=Z&&30>ja(D[Y].A,D[Z].A)&&D[Y].S.push(D[Z]);
var R=function(a){for(var b={key:[200],N:!1,P:!1,M:!1,W:!1,O:[0,0],update:function(){this.P=this.N=!1}},c=0;200>c;c++)b.key[c]=!1;q("keydown",function(e){b.key[e.keyCode]=!0});q("keyup",function(e){b.key[e.keyCode]=!1});q("click",function(){});q("mousedown",function(e){0==e.button&&(b.N=!0,b.M=!0);2==e.button&&(b.P=!0,b.M=!0)});q("mouseup",function(e){0==e.button&&(b.M=!1);2==e.button&&(b.W=!1)});q("mousemove",function(e){b.O[0]=e.clientX-a.left;b.O[1]=e.clientY-a.top});return b}(eb);I.push(R);
function Na(){var a=window.performance;return a&&a.now?a.now():(new Date).getTime()}function fb(){x.fillStyle="#101010";x.fillRect(0,0,U,X);x.fillStyle="#333333";x.strokeStyle="#101010";for(t=0;100>t;t++)for(w=0;100>w;w++)Ea();Da+=.001;Aa=Fa(Da);Ba=Fa(Da+.5);null!=S&&S.V(x);L.forEach(function(a){return a.R(x)})}function gb(){var a=T;R.N&&(S=Ja(),Ka());if(R.P){var b=Ja();null!=S&&null!=b&&(S==b?S.upgrade():S.X(b))}I.forEach(function(c){return c.update(a)})}var hb=requestAnimationFrame;
function ib(){Ma=Na();T=Math.min(1,(Ma-Oa)/1E3);T>Pa&&(T=Pa);Oa=Ma;gb();fb();hb(ib);U==cb.clientWidth&&X==cb.clientHeight||db()}hb(ib);function db(){U=cb.clientWidth;X=cb.clientHeight;bb=Math.min(U,X);B=.5*U;C=.5*X;A=.01*bb;Qa.width=U;Qa.height=X;var a=24;X>U&&(a*=X/U);x.font=parseInt(a)+"pt Arial"}function H(a,b,c,e){x.fillRect(a*A+B,b*A+C,c*A,e*A)};</script>
</html>