<html>
	<head>
		<title>Castles</title>
		<style type="text/css">
		body {
			display: block;
			background-color:0;
			width: 100%;
			height: 100%;
			margin: 0;
		}
		canvas {
			background-color:0;
			display: block;
			margin: 0px auto;
		}
		</style>
	</head>
	<body>
		<canvas id="a"></canvas>
	</body>
	<script type="text/javascript">

function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function ba(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if(b)return b.call(a);if("number"==typeof a.length)return{next:aa(a)};throw Error(String(a)+" is not an iterable or ArrayLike");}function ca(a){for(var b,d=[];!(b=a.next()).done;)d.push(b.value);return d}var da=Number.MAX_VALUE,ea=Number.MIN_VALUE,fa=Math.PI,ja=Math.cos,ka=Math.sin,la=Math.min,ma=Math.max,na=Math.round;
function l(a){return ma(la(a,1),0)}function m(a,b){return[a[0]-b[0],a[1]-b[1]]}function oa(a,b){return[a[0]*b,a[1]*b]}function pa(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function qa(a){var b=1/pa(a);Infinity==b&&(b=da);-Infinity==b&&(b=ea);return oa(a,b)}function u(a,b,d){return[void 0===a?0:a,void 0===b?0:b,void 0===d?0:d]}function v(a,b){return[a[0]+b[0],a[1]+b[1],a[2]+b[2]]}function w(a,b){return[a[0]*b,a[1]*b,a[2]*b]}
function ra(a,b){var d=a[0],e=a[1],c=a[2],h=b/180*fa,q=ja(h);h=ka(h);var f=1-q;return[d*d+(1-d*d)*q,d*e*f-c*h,d*c*f+e*h,d*e*f+c*h,e*e+(1-e*e)*q,e*c*f-d*h,d*c*f-e*h,e*c*f+d*h,c*c+(1-c*c)*q]}
function wa(){var a=ra(u(1,0,0),40),b=xa;return[a[0]*b[0]+a[1]*b[3]+a[2]*b[6],a[0]*b[1]+a[1]*b[4]+a[2]*b[7],a[0]*b[2]+a[1]*b[5]+a[2]*b[8],a[3]*b[0]+a[4]*b[3]+a[5]*b[6],a[3]*b[1]+a[4]*b[4]+a[5]*b[7],a[3]*b[2]+a[4]*b[5]+a[5]*b[8],a[6]*b[0]+a[7]*b[3]+a[8]*b[6],a[6]*b[1]+a[7]*b[4]+a[8]*b[7],a[6]*b[2]+a[7]*b[5]+a[8]*b[8]]}function ya(a){var b=za;return[a[0]*b[0]+a[1]*b[1]+a[2]*b[2],a[0]*b[3]+a[1]*b[4]+a[2]*b[5],a[0]*b[6]+a[1]*b[7]+a[2]*b[8]]}
function Aa(a){var b=Ba;a=[a[0],a[1],a[2],1];b=[a[0]*b[0]+a[1]*b[4]+a[2]*b[8]+a[3]*b[12],a[0]*b[1]+a[1]*b[5]+a[2]*b[9]+a[3]*b[13],a[0]*b[2]+a[1]*b[6]+a[2]*b[10]+a[3]*b[14],a[0]*b[3]+a[1]*b[7]+a[2]*b[11]+a[3]*b[15]];return[b[0]/b[3],b[1]/b[3],b[2]/b[3]]}function y(a,b){Ca.addEventListener(a,b,!1)}function Da(){this.ja=function(a){for(var b=0;24>b;b++)this[String.fromCharCode(97+b)]=a[b]||0;.01>this.c&&(this.c=.01);a=this.b+this.c+this.e;.18>a&&(a=.18/a,this.b*=a,this.c*=a,this.e*=a)}}
var Ea=new function(){this.L=new Da;var a,b,d,e,c,h,q,f,g,t,p,S;this.reset=function(){var n=this.L;e=100/(n.f*n.f+.001);c=100/(n.g*n.g+.001);h=1-n.h*n.h*n.h*.01;q=-n.i*n.i*n.i*1E-6;n.a||(p=.5-n.n/2,S=5E-5*-n.o);f=1+n.l*n.l*(0<n.l?-.9:10);g=0;t=1==n.m?0:(1-n.m)*(1-n.m)*2E4+32};this.la=function(){this.reset();var n=this.L;a=n.b*n.b*1E5;b=n.c*n.c*1E5;d=n.e*n.e*1E5+12;return 3*((a+b+d)/3|0)};this.ka=function(n,Ia){var k=this.L,Ja=1!=k.s||k.v,N=k.v*k.v*.1,Ka=1+3E-4*k.w,H=k.s*k.s*k.s*.1,tb=1+1E-4*k.t,ub=
1!=k.s,vb=k.x*k.x,wb=k.g,La=k.q||k.r,xb=k.r*k.r*k.r*.2,Ma=k.q*k.q*(0>k.q?-1020:1020),Na=k.p?((1-k.p)*(1-k.p)*2E4|0)+32:0,yb=k.d,Oa=k.j/2,zb=k.k*k.k*.01,sa=k.a,ta=a,Ab=1/a,Bb=1/b,Cb=1/d;k=5/(1+k.u*k.u*20)*(.01+H);.8<k&&(k=.8);k=1-k;for(var ua=!1,Pa=0,T=0,U=0,Qa=0,ha=0,V,W=0,x,I=0,J,va=0,r,Ra=0,O,Sa=0,ia=Array(1024),X=Array(32),A=ia.length;A--;)ia[A]=0;for(A=X.length;A--;)X[A]=2*Math.random()-1;for(A=0;A<Ia;A++){if(ua)return A;Na&&++Ra>=Na&&(Ra=0,this.reset());t&&++g>=t&&(t=0,e*=f);h+=q;e*=h;e>c&&(e=
c,0<wb&&(ua=!0));x=e;0<Oa&&(Sa+=zb,x*=1+Math.sin(Sa)*Oa);x|=0;8>x&&(x=8);sa||(p+=S,0>p?p=0:.5<p&&(p=.5));if(++T>ta)switch(T=0,++Pa){case 1:ta=b;break;case 2:ta=d}switch(Pa){case 0:U=T*Ab;break;case 1:U=1+2*(1-T*Bb)*yb;break;case 2:U=1-T*Cb;break;case 3:U=0,ua=!0}La&&(Ma+=xb,J=Ma|0,0>J?J=-J:1023<J&&(J=1023));Ja&&Ka&&(N*=Ka,1E-5>N?N=1E-5:.1<N&&(N=.1));O=0;for(var Db=8;Db--;){I++;if(I>=x&&(I%=x,3==sa))for(V=X.length;V--;)X[V]=2*Math.random()-1;switch(sa){case 0:r=I/x<p?.5:-.5;break;case 1:r=1-I/x*2;
break;case 2:r=I/x;r=6.28318531*(.5<r?r-1:r);r=1.27323954*r+.405284735*r*r*(0>r?1:-1);r=.225*((0>r?-1:1)*r*r-r)+r;break;case 3:r=X[Math.abs(32*I/x|0)]}Ja&&(V=W,H*=tb,0>H?H=0:.1<H&&(H=.1),ub?(ha+=(r-W)*H,ha*=k):(W=r,ha=0),W+=ha,Qa+=W-V,r=Qa*=1-N);La&&(ia[va%1024]=r,r+=ia[(va-J+1024)%1024],va++);O+=r}O*=.125*U*vb;n[A]=1<=O?32767:-1>=O?-32768:32767*O|0}return Ia}};
window.jsfxr=function(a){Ea.L.ja(a);var b=Ea.la();a=new Uint8Array(4*((b+1)/2|0)+44);b=2*Ea.ka(new Uint16Array(a.buffer,44),b);var d=new Uint32Array(a.buffer,0,44);d[0]=1179011410;d[1]=b+36;d[2]=1163280727;d[3]=544501094;d[4]=16;d[5]=65537;d[6]=44100;d[7]=88200;d[8]=1048578;d[9]=1635017060;d[10]=b;b+=44;d=0;for(var e="data:audio/wav;base64,";d<b;d+=3){var c=a[d]<<16|a[d+1]<<8|a[d+2];e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[c>>18]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[c>>
12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[c>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[c&63]}return e};var z=[],za=[1,0,0,0,1,0,0,0,1],Ba;Ba=[1,0,0,0,0,1,0,0,0,0,5/3,-1,0,0,-8/3,0];var Fa=u(0,0,-1E3),Ga=u(),Ha=null,Ta=null;function Ua(){for(var a=0;a<z.length;a++)z[a].ga();z.sort(Va);for(a=0;a<z.length;a++)z[a].N()}function Va(a,b){return a.depth<b.depth?1:a.depth>b.depth?-1:0}
function B(a){a=v(a,w(Ga,-1));a=ya(a);a=v(a,Fa);a=Aa(a);a=w(a,Ta);return v(a,Ha)}var Wa=[u(-1,-1),u(-1,1),u(1,1),u(1,-1)];
function Xa(a,b,d){function e(c){var h=na(255*l(c[0])),q=na(255*l(c[1]));c=na(255*l(c[2]));return Ya(h,q,c)}d=void 0===d?u():d;a={Z:a,position:v(a,u(0,0,0)),height:0,scale:b,points:C(),S:C(),ca:C(),color:d,Y:[d,d,d,d],aa:[0,0,0,0],H:[C(),C(),C(),C()],depth:0,X:function(c){this.height=c},setColor:function(c){this.color=e(c);this.Y=[e(w(c,.9)),e(w(c,.7)),e(w(c,.5)),e(w(c,.7))]},ga:function(){for(var c=0;4>c;c++)this.points[c]=v(v(this.Z,w(Wa[c],this.scale)),u(0,0,this.height));c=v(this.position,w(Ga,
-1));c=ya(c);c=v(c,Fa);c=Aa(c);this.depth=c[2];for(c=0;4>c;c++)this.ca[c]=B(this.points[c]);for(c=0;4>c;c++){var h=this.aa[c];this.height<h&&(h=this.height);for(var q=0;4>q;q++)this.S[q]=v(v(this.Z,w(Wa[q],this.scale)),u(0,0,h));this.H[c][0]=B(this.points[(c+1)%4]);this.H[c][1]=B(this.points[(c+0)%4]);this.H[c][2]=B(this.S[(c+0)%4]);this.H[c][3]=B(this.S[(c+1)%4])}},N:function(){if(!(-1>=this.height)){D.fillStyle=this.color;Za(this.ca);for(var c=0;c<this.H.length;c++)D.fillStyle=this.Y[c],Za(this.H[c])}}};
z.push(a);return a}function Za(a){var b=a[0],d=m(a[1],b);d=qa([d[1],-d[0]]);b=m(b,a[2]);if(!(0<d[0]*b[0]+d[1]*b[1])){D.beginPath();b=a[3];D.moveTo(b[0],b[1]);for(b=0;4>b;b++)D.lineTo(a[b][0],a[b][1]);D.closePath();D.fill()}}function C(){var a=u();return[a,a,a,a]}function Ya(a,b,d){function e(h){h=h.toString(16);return 1==h.length?"0"+h:h}var c=void 0===c?255:c;return"#"+e(a)+e(b)+e(d)+e(c)}
var $a=function(a,b){function d(f,g,t,p,S){g=E(g,t,p);return 0<=g&&g<f.length?f[g]:void 0===S?null:S}var e={D:[],M:[],K:[],size:a,X:function(f,g,t){var p=this.D;f=E(f,g,this.size);0<=f&&f<p.length&&(p[f]=t)},na:function(f,g){return d(this.D,f,g,this.size,0)},setColor:function(f,g,t){var p=this.M;f=E(f,g,this.size);0<=f&&f<p.length&&(p[f]=t)},ma:function(f,g){return d(this.M,f,g,this.size,u())},ha:function(){for(F=0;F<this.size;F++)for(G=0;G<this.size;G++){var f=E(F,G,this.size);this.K[f].X(this.D[f]);
this.K[f].setColor(this.M[f])}}},c=.5*(a-1),h=.5*b;for(F=0;F<e.size;F++)for(G=0;G<e.size;G++){e.D.push(0);var q=u();e.K.push(Xa(u((F-c)*b,(G-c)*b),h,q));e.M.push(q)}for(F=1;F<e.size-1;F++)for(G=1;G<e.size-1;G++)c=e.D[E(F,G,e.size)],e.K[E(F,G,e.size)].aa=[e.D[E(F-1,G,e.size)],e.D[E(F,G+1,e.size)],e.D[E(F+1,G,e.size)],e.D[E(F,G-1,e.size)]],e.K[E(F,G,a)].Y=[K(.9*c),K(1.1*c),K(.9*c),K(.7*c)];return e}(35,60);
for(F=0;35>F;F++)for(G=0;35>G;G++){var ab=80*Math.random(),L=u(F-17,G-17),bb=l(Math.sqrt(L[0]*L[0]+L[1]*L[1]+L[2]*L[2])/17*2.8-1);ab*=bb;0<F&&0<G&&34>F&&34>G||(ab=-1);$a.X(F,G,ab);$a.setColor(F,G,K(ab/80))}$a.ha();function K(a){var b=l(.3+.1*a),d=l(.5+.5*a);a=l(.3+.1*a);return u(b,d,a)}function E(a,b,d){return a*(void 0===d?1:d)+1*b}var M=[];
function cb(a,b,d,e){var c=[1,2,3],h=[1,2,3],q=[15,20,999],f={A:[a,b],C:void 0===d?-1:d,R:0,ba:null,target:null,level:void 0===e?0:e,B:10,max:100,P:1,J:0,$:[],I:0,G:null,N:function(){D.fillStyle=db(f.C);var g=c[this.level];eb(f.A[0]-g,f.A[1]-g,g+g,g+g);D.textAlign="center";D.fillText(f.B,f.A[0]*P+fb,(f.A[1]-g-1)*P+gb);f.B>=q[f.level]&&eb(f.A[0]+g+g,f.A[1]-g-g-1,1,1)},ea:function(){D.fillStyle="#FFFFFF";var g=c[this.level]+1;eb(f.A[0]-g,f.A[1]-g,g+g,g+g);D.fillStyle="#FF00FF";M.forEach(function(t){if(null!=
t.G){var p=c[t.level]+1;eb(t.A[0]-p,t.A[1]-p,p+p,p+p)}})},upgrade:function(){this.B>=q[f.level]&&(this.B-=q[f.level],this.level+=1)},update:function(g){this.P-=g;0>=this.P&&(this.P=1,0<=this.C&&f.B<f.max&&(this.B+=h[this.level]));0<this.J?this.J-=g:0<this.B&&0<this.R?(--this.B,--this.R,hb(this.A[0],this.A[1],this.C,this.ba),this.J+=.2):this.target=null},contains:function(g,t){var p=f.A;return p[0]-3<g&&p[1]-3<t&&p[0]+3>g&&p[1]+3>t},attack:function(g){this.C==g?this.B+=1:0>=this.B?(this.C=g,this.B=
1):--this.B},ia:function(g){if(null!=g&&null!=g.G){this.target=g;this.R=this.B/2;var t=[];for(t.push(g);null!=g.G;)g=g.G,t.push(g);this.ba=t}}};Q.push(f);ib.push(f);M.push(f)}function db(a){switch(a){case 0:return"#0000FF";case 1:return"#FF0000";case 2:return"#00FF00";default:return"#555555"}}function jb(){var a=kb.V,b=(a[0]-fb)/P;a=(a[1]-gb)/P;for(var d=0;d<M.length;d++)if(M[d].contains(b,a))return M[d];return null}
function lb(){var a=R;M.forEach(function(e){e.I=99999;e.G=null});if(null!=a){var b=[];b.push(a);a.I=0;for(var d={};0<b.length;)d={F:d.F},d.F=b.pop(),d.F.$.forEach(function(e){return function(c){var h=e.F.I+pa(m(e.F.A,c.A));c.I>h&&(c.I=h,c.G=e.F,c.C==a.C&&b.push(c))}}(d))}}var mb=[0,0];
function hb(a,b,d,e){var c={A:[a,b],da:mb,O:0,C:d,target:null,path:[].concat(e instanceof Array?e:ca(ba(e))),B:1,N:function(h){h.fillStyle=db(c.C);eb(c.A[0]-1,c.A[1]-1,2,2)},update:function(h){var q=c.A,f=oa(c.da,h);c.A=[q[0]+f[0],q[1]+f[1]];c.O-=h;0>=c.O&&(0<c.path.length?(c.target=c.path.pop(),h=m(c.target.A,c.A),q=pa(h),c.da=oa(qa(h),10),c.O=q/10):(c.target.attack(c.C),h=Q.indexOf(c),-1<h&&Q.splice(h,1),h=ib.indexOf(c),-1<h&&ib.splice(h,1)))}};Q.push(c);ib.push(c)}
var nb,ob=0,qb=pb(),rb=1/30,Ca=document,sb=Ca.getElementById("a"),D=sb.getContext("2d"),Y=1,Z=1,Eb=1,fb=1,gb=1,P=1,Fb=Ca.documentElement,xa=[1,0,0,0,1,0,0,0,1],Gb=0;Hb();var Ib=sb.getBoundingClientRect(),R=null,Q=[],ib=[];cb(-40,0,0,2);cb(40,0,1,2);for(var F=-1;2>F;F++)for(var G=-1;2>G;G++)cb(20*F,20*G);for(var Jb=0;Jb<M.length;Jb++)for(var Kb=0;Kb<M.length;Kb++)Jb!=Kb&&30>pa(m(M[Jb].A,M[Kb].A))&&M[Jb].$.push(M[Kb]);
var kb=function(a){for(var b={key:[200],U:!1,W:!1,T:!1,fa:!1,V:[0,0],update:function(){this.W=this.U=!1}},d=0;200>d;d++)b.key[d]=!1;y("keydown",function(e){b.key[e.keyCode]=!0});y("keyup",function(e){b.key[e.keyCode]=!1});y("click",function(){});y("mousedown",function(e){0==e.button&&(b.U=!0,b.T=!0);2==e.button&&(b.W=!0,b.T=!0)});y("mouseup",function(e){0==e.button&&(b.T=!1);2==e.button&&(b.fa=!1)});y("mousemove",function(e){b.V[0]=e.clientX-a.left;b.V[1]=e.clientY-a.top});return b}(Ib);Q.push(kb);
function pb(){var a=window.performance;return a&&a.now?a.now():(new Date).getTime()}function Lb(){D.fillStyle="#101010";D.fillRect(0,0,Y,Z);Ua();D.fillStyle="#333333";D.strokeStyle="#101010";null!=R&&R.ea(D);ib.forEach(function(a){return a.N(D)})}function Mb(){var a=ob;kb.U&&(R=jb(),lb());if(kb.W){var b=jb();null!=R&&null!=b&&(R==b?R.upgrade():R.ia(b))}kb.key[32]&&console.log(z);Q.forEach(function(d){return d.update(a)});Gb+=.1*a;xa=ra(u(0,0,1),10*ka(Gb)+45);za=wa()}var Nb=requestAnimationFrame;
function Ob(){nb=pb();ob=Math.min(1,(nb-qb)/1E3);ob>rb&&(ob=rb);qb=nb;Mb();Lb();Nb(Ob);Y==Fb.clientWidth&&Z==Fb.clientHeight||Hb()}Nb(Ob);function Hb(){Y=Fb.clientWidth;Z=Fb.clientHeight;Eb=Math.min(Y,Z);fb=.5*Y;gb=.5*Z;P=.01*Eb;sb.width=Y;sb.height=Z;var a=24;Z>Y&&(a*=Z/Y);D.font=parseInt(a)+"pt Arial";a=Y;var b=Z;Ha=u(.5*a,.5*b);Ta=Math.min(a,b)}function eb(a,b,d,e){D.fillRect(a*P+fb,b*P+gb,d*P,e*P)};



</script>
</html>