<html>
	<head>
		<title>Castles</title>
		<style type="text/css">
		body {
			display: block;
			background-color:0;
			width: 100%;
			height: 100%;
			margin: 0;
		}
		canvas {
			background-color:0;
			display: block;
			margin: 0px auto;
		}
		</style>
	</head>
	<body>
		<canvas id="a"></canvas>
	</body>
	<script type="text/javascript">

function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function ba(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if(b)return b.call(a);if("number"==typeof a.length)return{next:aa(a)};throw Error(String(a)+" is not an iterable or ArrayLike");}function ca(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}var da=Number.MAX_VALUE,ea=Number.MIN_VALUE,fa=Math.PI,ha=Math.cos,ia=Math.sin;
function q(a,b){return[a[0]-b[0],a[1]-b[1]]}function na(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function oa(a){var b=1/na(a);Infinity==b&&(b=da);-Infinity==b&&(b=ea);return[a[0]*b,a[1]*b]}function t(a,b,c){return[void 0===a?0:a,void 0===b?0:b,void 0===c?0:c]}function u(a,b){return[a[0]+b[0],a[1]+b[1],a[2]+b[2]]}function pa(a,b){return[a[0]*b,a[1]*b,a[2]*b]}
function qa(a,b){var c=a[0],f=a[1],d=a[2],e=b/180*fa,g=ha(e);e=ia(e);var h=1-g;return[c*c+(1-c*c)*g,c*f*h-d*e,c*d*h+f*e,c*f*h+d*e,f*f+(1-f*f)*g,f*d*h-c*e,c*d*h-f*e,f*d*h+c*e,d*d+(1-d*d)*g]}
function ra(){var a=qa(t(1,0,0),60),b=qa(t(0,0,1),sa);return[a[0]*b[0]+a[1]*b[3]+a[2]*b[6],a[0]*b[1]+a[1]*b[4]+a[2]*b[7],a[0]*b[2]+a[1]*b[5]+a[2]*b[8],a[3]*b[0]+a[4]*b[3]+a[5]*b[6],a[3]*b[1]+a[4]*b[4]+a[5]*b[7],a[3]*b[2]+a[4]*b[5]+a[5]*b[8],a[6]*b[0]+a[7]*b[3]+a[8]*b[6],a[6]*b[1]+a[7]*b[4]+a[8]*b[7],a[6]*b[2]+a[7]*b[5]+a[8]*b[8]]}function v(a,b){Fa.addEventListener(a,b,!1)}
function Ga(){this.ba=function(a){for(var b=0;24>b;b++)this[String.fromCharCode(97+b)]=a[b]||0;.01>this.c&&(this.c=.01);a=this.b+this.c+this.e;.18>a&&(a=.18/a,this.b*=a,this.c*=a,this.e*=a)}}
var Ha=new function(){this.K=new Ga;var a,b,c,f,d,e,g,h,k,r,n,ta;this.reset=function(){var m=this.K;f=100/(m.f*m.f+.001);d=100/(m.g*m.g+.001);e=1-m.h*m.h*m.h*.01;g=-m.i*m.i*m.i*1E-6;m.a||(n=.5-m.n/2,ta=5E-5*-m.o);h=1+m.l*m.l*(0<m.l?-.9:10);k=0;r=1==m.m?0:(1-m.m)*(1-m.m)*2E4+32};this.da=function(){this.reset();var m=this.K;a=m.b*m.b*1E5;b=m.c*m.c*1E5;c=m.e*m.e*1E5+12;return 3*((a+b+c)/3|0)};this.ca=function(m,ua){var l=this.K,va=1!=l.s||l.v,H=l.v*l.v*.1,wa=1+3E-4*l.w,C=l.s*l.s*l.s*.1,cb=1+1E-4*l.t,
db=1!=l.s,eb=l.x*l.x,fb=l.g,xa=l.q||l.r,gb=l.r*l.r*l.r*.2,ya=l.q*l.q*(0>l.q?-1020:1020),za=l.p?((1-l.p)*(1-l.p)*2E4|0)+32:0,hb=l.d,Aa=l.j/2,ib=l.k*l.k*.01,ja=l.a,ka=a,jb=1/a,kb=1/b,lb=1/c;l=5/(1+l.u*l.u*20)*(.01+C);.8<l&&(l=.8);l=1-l;for(var la=!1,Ba=0,N=0,O=0,Ca=0,Y=0,P,Q=0,w,D=0,E,ma=0,p,Da=0,I,Ea=0,Z=Array(1024),R=Array(32),x=Z.length;x--;)Z[x]=0;for(x=R.length;x--;)R[x]=2*Math.random()-1;for(x=0;x<ua;x++){if(la)return x;za&&++Da>=za&&(Da=0,this.reset());r&&++k>=r&&(r=0,f*=h);e+=g;f*=e;f>d&&(f=
d,0<fb&&(la=!0));w=f;0<Aa&&(Ea+=ib,w*=1+Math.sin(Ea)*Aa);w|=0;8>w&&(w=8);ja||(n+=ta,0>n?n=0:.5<n&&(n=.5));if(++N>ka)switch(N=0,++Ba){case 1:ka=b;break;case 2:ka=c}switch(Ba){case 0:O=N*jb;break;case 1:O=1+2*(1-N*kb)*hb;break;case 2:O=1-N*lb;break;case 3:O=0,la=!0}xa&&(ya+=gb,E=ya|0,0>E?E=-E:1023<E&&(E=1023));va&&wa&&(H*=wa,1E-5>H?H=1E-5:.1<H&&(H=.1));I=0;for(var mb=8;mb--;){D++;if(D>=w&&(D%=w,3==ja))for(P=R.length;P--;)R[P]=2*Math.random()-1;switch(ja){case 0:p=D/w<n?.5:-.5;break;case 1:p=1-D/w*2;
break;case 2:p=D/w;p=6.28318531*(.5<p?p-1:p);p=1.27323954*p+.405284735*p*p*(0>p?1:-1);p=.225*((0>p?-1:1)*p*p-p)+p;break;case 3:p=R[Math.abs(32*D/w|0)]}va&&(P=Q,C*=cb,0>C?C=0:.1<C&&(C=.1),db?(Y+=(p-Q)*C,Y*=l):(Q=p,Y=0),Q+=Y,Ca+=Q-P,p=Ca*=1-H);xa&&(Z[ma%1024]=p,p+=Z[(ma-E+1024)%1024],ma++);I+=p}I*=.125*O*eb;m[x]=1<=I?32767:-1>=I?-32768:32767*I|0}return ua}};
window.jsfxr=function(a){Ha.K.ba(a);var b=Ha.da();a=new Uint8Array(4*((b+1)/2|0)+44);b=2*Ha.ca(new Uint16Array(a.buffer,44),b);var c=new Uint32Array(a.buffer,0,44);c[0]=1179011410;c[1]=b+36;c[2]=1163280727;c[3]=544501094;c[4]=16;c[5]=65537;c[6]=44100;c[7]=88200;c[8]=1048578;c[9]=1635017060;c[10]=b;b+=44;c=0;for(var f="data:audio/wav;base64,";c<b;c+=3){var d=a[c]<<16|a[c+1]<<8|a[c+2];f+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>18]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>
12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d&63]}return f};var y=[],Ia=[1,0,0,0,1,0,0,0,1],z;z=[1,0,0,0,0,1,0,0,0,0,3,-1,0,0,-4,0];var Ja=t(0,0,-1E3),Ka=t(),La=null,Ma=null;function Na(){for(var a=0;a<y.length;a++)y[a].Z();y.sort(Oa);for(a=0;a<y.length;a++)y[a].L()}function Oa(a,b){return a.I[2]<b.I[2]?-1:a.I[2]>b.I[2]?1:0}
function Pa(a){a=u(a,pa(Ka,-1));var b=Ia;a=[a[0]*b[0]+a[1]*b[1]+a[2]*b[2],a[0]*b[3]+a[1]*b[4]+a[2]*b[5],a[0]*b[6]+a[1]*b[7]+a[2]*b[8]];a=u(a,Ja);a=[a[0],a[1],a[2],1];a=[a[0]*z[0]+a[1]*z[4]+a[2]*z[8]+a[3]*z[12],a[0]*z[1]+a[1]*z[5]+a[2]*z[9]+a[3]*z[13],a[0]*z[2]+a[1]*z[6]+a[2]*z[10]+a[3]*z[14],a[0]*z[3]+a[1]*z[7]+a[2]*z[11]+a[3]*z[15]];a=[a[0]/a[3],a[1]/a[3],a[2]/a[3]];a=pa(a,Ma);return u(a,La)}
function Qa(a,b,c,f,d){var e={D:[a,b,c,f],I:t(),color:void 0===d?"#FFEEEE":d,aa:function(g,h,k,r,n){n=void 0===n?null:n;e.points=[g,h,k,r];if(null==n){g=e.points;h=t();for(k=0;k<g.length;k++)h=u(h,g[k]);g=pa(h,1/parseFloat(g.length))}else g=n;e.position=g},Z:function(){e.I=Pa(e.position);for(var g=0;g<e.D.length;g++)e.D[g]=Pa(e.points[g])},L:function(){var g=e.D[0],h=q(e.D[1],g);h=oa([h[1],-h[0]]);g=q(g,e.D[2]);if(!(0<h[0]*g[0]+h[1]*g[1])){A.fillStyle=e.color;A.strokeStyle=e.color;A.beginPath();g=
e.D[e.D.length-1];A.moveTo(g[0],g[1]);for(g=0;g<e.D.length;g++)A.lineTo(e.D[g][0],e.D[g][1]);A.closePath();A.fill()}}};e.aa(a,b,c,f);y.push(e)}var Ra=[];for(B=0;100>B;B++)for(F=0;100>F;F++)Ra.push(3*Math.random());var G=[];
function Sa(a,b,c,f){var d=[1,2,3],e=[1,2,3],g=[15,20,999],h={A:[a,b],C:void 0===c?-1:c,O:0,V:null,target:null,level:void 0===f?0:f,B:10,max:100,N:1,J:0,U:[],H:0,G:null,L:function(){A.fillStyle=Ta(h.C);var k=d[this.level];J(h.A[0]-k,h.A[1]-k,k+k,k+k);A.textAlign="center";A.fillText(h.B,h.A[0]*K+Ua,(h.A[1]-k-1)*K+Va);h.B>=g[h.level]&&J(h.A[0]+k+k,h.A[1]-k-k-1,1,1)},X:function(){A.fillStyle="#FFFFFF";var k=d[this.level]+1;J(h.A[0]-k,h.A[1]-k,k+k,k+k);A.fillStyle="#FF00FF";G.forEach(function(r){if(null!=
r.G){var n=d[r.level]+1;J(r.A[0]-n,r.A[1]-n,n+n,n+n)}})},upgrade:function(){this.B>=g[h.level]&&(this.B-=g[h.level],this.level+=1)},update:function(k){this.N-=k;0>=this.N&&(this.N=1,0<=this.C&&h.B<h.max&&(this.B+=e[this.level]));0<this.J?this.J-=k:0<this.B&&0<this.O?(--this.B,--this.O,Wa(this.A[0],this.A[1],this.C,this.V),this.J+=.2):this.target=null},contains:function(k,r){var n=h.A;return n[0]-3<k&&n[1]-3<r&&n[0]+3>k&&n[1]+3>r},attack:function(k){this.C==k?this.B+=1:0>=this.B?(this.C=k,this.B=1):
--this.B},$:function(k){if(null!=k&&null!=k.G){this.target=k;this.O=this.B/2;var r=[];for(r.push(k);null!=k.G;)k=k.G,r.push(k);this.V=r}}};L.push(h);M.push(h);G.push(h)}function Ta(a){switch(a){case 0:return"#0000FF";case 1:return"#FF0000";case 2:return"#00FF00";default:return"#555555"}}function Xa(){var a=S.S,b=(a[0]-Ua)/K;a=(a[1]-Va)/K;for(var c=0;c<G.length;c++)if(G[c].contains(b,a))return G[c];return null}
function Ya(){var a=T;G.forEach(function(f){f.H=99999;f.G=null});if(null!=a){var b=[];b.push(a);a.H=0;for(var c={};0<b.length;)c={F:c.F},c.F=b.pop(),c.F.U.forEach(function(f){return function(d){var e=f.F.H+na(q(f.F.A,d.A));d.H>e&&(d.H=e,d.G=f.F,d.C==a.C&&b.push(d))}}(c))}}var Za=[0,0];
function Wa(a,b,c,f){var d={A:[a,b],W:Za,M:0,C:c,target:null,path:[].concat(f instanceof Array?f:ca(ba(f))),B:1,L:function(e){e.fillStyle=Ta(d.C);J(d.A[0]-1,d.A[1]-1,2,2)},update:function(e){var g=d.W;g=[g[0]*e,g[1]*e];var h=d.A;d.A=[h[0]+g[0],h[1]+g[1]];d.M-=e;0>=d.M&&(0<d.path.length?(d.target=d.path.pop(),g=q(d.target.A,d.A),e=oa(g),g=magnitude(g),d.W=[10*e[0],10*e[1]],d.M=g/10):(d.target.attack(d.C),e=L.indexOf(d),-1<e&&L.splice(e,1),e=M.indexOf(d),-1<e&&M.splice(e,1)))}};L.push(d);M.push(d)}
var $a,ab=0,nb=bb(),ob=1/30,Fa=document,pb=Fa.getElementById("a"),A=pb.getContext("2d"),U=1,V=1,qb=1,Ua=1,Va=1,K=1,rb=Fa.documentElement,sa=0;sb();var tb=pb.getBoundingClientRect(),T=null,L=[],M=[];Sa(-40,0,0,2);Sa(40,0,1,2);for(var B=-1;2>B;B++)for(var F=-1;2>F;F++)Sa(20*B,20*F+10);for(var W=0;W<G.length;W++)for(var X=0;X<G.length;X++)W!=X&&30>na(q(G[W].A,G[X].A))&&G[W].U.push(G[X]);
var S=function(a){for(var b={key:[200],R:!1,T:!1,P:!1,Y:!1,S:[0,0],update:function(){this.T=this.R=!1}},c=0;200>c;c++)b.key[c]=!1;v("keydown",function(f){b.key[f.keyCode]=!0});v("keyup",function(f){b.key[f.keyCode]=!1});v("click",function(){});v("mousedown",function(f){0==f.button&&(b.R=!0,b.P=!0);2==f.button&&(b.T=!0,b.P=!0)});v("mouseup",function(f){0==f.button&&(b.P=!1);2==f.button&&(b.Y=!1)});v("mousemove",function(f){b.S[0]=f.clientX-a.left;b.S[1]=f.clientY-a.top});return b}(tb);L.push(S);
function bb(){var a=window.performance;return a&&a.now?a.now():(new Date).getTime()}var ub=t(-100,-100,-100),vb=t(-100,100,-100),wb=t(100,100,-100),xb=t(100,-100,-100);Qa(t(-100,-100,100),t(-100,100,100),t(100,100,100),t(100,-100,100));Qa(ub,vb,wb,xb,yb());function zb(){A.fillStyle="#101010";A.fillRect(0,0,U,V);Na();A.fillStyle="#333333";A.strokeStyle="#101010";null!=T&&T.X(A);M.forEach(function(a){return a.L(A)})}
function Ab(){var a=ab;S.R&&(T=Xa(),Ya());if(S.T){var b=Xa();null!=T&&null!=b&&(T==b?T.upgrade():T.$(b))}S.key[32]&&console.log(y);L.forEach(function(c){return c.update(a)});sa+=60*a;Ia=ra()}var Bb=requestAnimationFrame;function Cb(){$a=bb();ab=Math.min(1,($a-nb)/1E3);ab>ob&&(ab=ob);nb=$a;Ab();zb();Bb(Cb);U==rb.clientWidth&&V==rb.clientHeight||sb()}Bb(Cb);
function sb(){U=rb.clientWidth;V=rb.clientHeight;qb=Math.min(U,V);Ua=.5*U;Va=.5*V;K=.01*qb;pb.width=U;pb.height=V;var a=24;V>U&&(a*=V/U);A.font=parseInt(a)+"pt Arial";a=U;var b=V;La=t(.5*a,.5*b);Ma=Math.min(a,b)}function J(a,b,c,f){A.fillRect(a*K+Ua,b*K+Va,c*K,f*K)}function yb(){function a(c){c=c.toString(16);return 1==c.length?"0"+c:c}var b=void 0===b?255:b;return"#"+a(255)+a(3)+a(8)+a(b)};

</script>
</html>