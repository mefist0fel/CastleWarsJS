<html>
	<head>
		<title>Castles</title>
		<style type="text/css">
		body {
			display: block;
			background-color:0;
			width: 100%;
			height: 100%;
			margin: 0;
		}
		canvas {
			background-color:0;
			display: block;
			margin: 0px auto;
		}
		</style>
	</head>
	<body>
		<canvas id="a"></canvas>
	</body>
	<script type="text/javascript">
function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function ba(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if(b)return b.call(a);if("number"==typeof a.length)return{next:aa(a)};throw Error(String(a)+" is not an iterable or ArrayLike");}function ca(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}function qa(a,b){return Math.sqrt((a[0]-b[0])*(a[0]-b[0])+(a[1]-b[1])*(a[1]-b[1]))}
function r(a,b){return[a[0]*b,a[1]*b,a[2]*b]}function ra(){this.Y=function(a){for(var b=0;24>b;b++)this[String.fromCharCode(97+b)]=a[b]||0;.01>this.c&&(this.c=.01);a=this.b+this.c+this.e;.18>a&&(a=.18/a,this.b*=a,this.c*=a,this.e*=a)}}
var u=new function(){this.I=new ra;var a,b,c,k,d,g,q,h,e,p,n,da;this.reset=function(){var l=this.I;k=100/(l.f*l.f+.001);d=100/(l.g*l.g+.001);g=1-l.h*l.h*l.h*.01;q=-l.i*l.i*l.i*1E-6;l.a||(n=.5-l.n/2,da=5E-5*-l.o);h=1+l.l*l.l*(0<l.l?-.9:10);e=0;p=1==l.m?0:(1-l.m)*(1-l.m)*2E4+32};this.$=function(){this.reset();var l=this.I;a=l.b*l.b*1E5;b=l.c*l.c*1E5;c=l.e*l.e*1E5+12;return 3*((a+b+c)/3|0)};this.Z=function(l,ea){var f=this.I,fa=1!=f.s||f.v,A=f.v*f.v*.1,ha=1+3E-4*f.w,x=f.s*f.s*f.s*.1,Ca=1+1E-4*f.t,Da=
1!=f.s,Ea=f.x*f.x,Fa=f.g,ia=f.q||f.r,Ga=f.r*f.r*f.r*.2,ja=f.q*f.q*(0>f.q?-1020:1020),ka=f.p?((1-f.p)*(1-f.p)*2E4|0)+32:0,Ha=f.d,la=f.j/2,Ia=f.k*f.k*.01,T=f.a,U=a,Ja=1/a,Ka=1/b,La=1/c;f=5/(1+f.u*f.u*20)*(.01+x);.8<f&&(f=.8);f=1-f;for(var V=!1,ma=0,D=0,E=0,na=0,M=0,F,G=0,t,y=0,z,W=0,m,oa=0,B,pa=0,N=Array(1024),H=Array(32),v=N.length;v--;)N[v]=0;for(v=H.length;v--;)H[v]=2*Math.random()-1;for(v=0;v<ea;v++){if(V)return v;ka&&++oa>=ka&&(oa=0,this.reset());p&&++e>=p&&(p=0,k*=h);g+=q;k*=g;k>d&&(k=d,0<Fa&&
(V=!0));t=k;0<la&&(pa+=Ia,t*=1+Math.sin(pa)*la);t|=0;8>t&&(t=8);T||(n+=da,0>n?n=0:.5<n&&(n=.5));if(++D>U)switch(D=0,++ma){case 1:U=b;break;case 2:U=c}switch(ma){case 0:E=D*Ja;break;case 1:E=1+2*(1-D*Ka)*Ha;break;case 2:E=1-D*La;break;case 3:E=0,V=!0}ia&&(ja+=Ga,z=ja|0,0>z?z=-z:1023<z&&(z=1023));fa&&ha&&(A*=ha,1E-5>A?A=1E-5:.1<A&&(A=.1));B=0;for(var Ma=8;Ma--;){y++;if(y>=t&&(y%=t,3==T))for(F=H.length;F--;)H[F]=2*Math.random()-1;switch(T){case 0:m=y/t<n?.5:-.5;break;case 1:m=1-y/t*2;break;case 2:m=
y/t;m=6.28318531*(.5<m?m-1:m);m=1.27323954*m+.405284735*m*m*(0>m?1:-1);m=.225*((0>m?-1:1)*m*m-m)+m;break;case 3:m=H[Math.abs(32*y/t|0)]}fa&&(F=G,x*=Ca,0>x?x=0:.1<x&&(x=.1),Da?(M+=(m-G)*x,M*=f):(G=m,M=0),G+=M,na+=G-F,m=na*=1-A);ia&&(N[W%1024]=m,m+=N[(W-z+1024)%1024],W++);B+=m}B*=.125*E*Ea;l[v]=1<=B?32767:-1>=B?-32768:32767*B|0}return ea}};
window.jsfxr=function(a){u.I.Y(a);var b=u.$();a=new Uint8Array(4*((b+1)/2|0)+44);b=2*u.Z(new Uint16Array(a.buffer,44),b);var c=new Uint32Array(a.buffer,0,44);c[0]=1179011410;c[1]=b+36;c[2]=1163280727;c[3]=544501094;c[4]=16;c[5]=65537;c[6]=44100;c[7]=88200;c[8]=1048578;c[9]=1635017060;c[10]=b;b+=44;c=0;for(var k="data:audio/wav;base64,";c<b;c+=3){var d=a[c]<<16|a[c+1]<<8|a[c+2];k+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>18]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>
12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d&63]}return k};var w=[];
function C(a,b,c,k){var d=[1,2,3],g=[1,2,3],q=[15,20,999],h={A:[a,b],C:void 0===c?-1:c,L:0,T:null,target:null,level:void 0===k?0:k,B:10,max:100,K:1,H:0,S:[],G:0,F:null,R:function(){I.fillStyle=sa(h.C);var e=d[this.level];J(h.A[0]-e,h.A[1]-e,e+e,e+e);I.textAlign="center";I.fillText(h.B,h.A[0]*screenScale+centerX,(h.A[1]-e-1)*screenScale+centerY);h.B>=q[h.level]&&J(h.A[0]+e+e,h.A[1]-e-e-1,1,1)},V:function(){I.fillStyle="#FFFFFF";var e=d[this.level]+1;J(h.A[0]-e,h.A[1]-e,e+e,e+e);I.fillStyle="#FF00FF";
w.forEach(function(p){if(null!=p.F){var n=d[p.level]+1;J(p.A[0]-n,p.A[1]-n,n+n,n+n)}})},upgrade:function(){this.B>=q[h.level]&&(this.B-=q[h.level],this.level+=1)},update:function(e){this.K-=e;0>=this.K&&(this.K=1,0<=this.C&&h.B<h.max&&(this.B+=g[this.level]));0<this.H?this.H-=e:0<this.B&&0<this.L?(--this.B,--this.L,ta(this.A[0],this.A[1],this.C,this.T),this.H+=.2):this.target=null},contains:function(e,p){var n=h.A;return n[0]-3<e&&n[1]-3<p&&n[0]+3>e&&n[1]+3>p},attack:function(e){this.C==e?this.B+=
1:0>=this.B?(this.C=e,this.B=1):--this.B},X:function(e){if(null!=e&&null!=e.F){this.target=e;this.L=this.B/2;var p=[];for(p.push(e);null!=e.F;)e=e.F,p.push(e);this.T=p}}};K.push(h);L.push(h);w.push(h)}function sa(a){switch(a){case 0:return"#0000FF";case 1:return"#FF0000";case 2:return"#00FF00";default:return"#555555"}}function ua(){var a=O.O,b=(a[0]-centerX)/screenScale;a=(a[1]-centerY)/screenScale;for(var c=0;c<w.length;c++)if(w[c].contains(b,a))return w[c];return null}
function va(){var a=P;w.forEach(function(k){k.G=99999;k.F=null});if(null!=a){var b=[];b.push(a);a.G=0;for(var c={};0<b.length;)c={D:c.D},c.D=b.pop(),c.D.S.forEach(function(k){return function(d){var g=k.D.G+qa(k.D.A,d.A);d.G>g&&(d.G=g,d.F=k.D,d.C==a.C&&b.push(d))}}(c))}}var wa=[0,0];
function ta(a,b,c,k){var d={A:[a,b],U:wa,J:0,C:c,target:null,path:[].concat(k instanceof Array?k:ca(ba(k))),B:1,R:function(g){g.fillStyle=sa(d.C);J(d.A[0]-1,d.A[1]-1,2,2)},update:function(g){var q=d.A,h=r(d.U,g);d.A=[q[0]+h[0],q[1]+h[1]];d.J-=g;0>=d.J&&(0<d.path.length?(d.target=d.path.pop(),g=d.target.A,q=d.A,g=[g[0]-q[0],g[1]-q[1]],q=Math.sqrt(g[0]*g[0]+g[1]*g[1]),h=1/Math.sqrt(g[0]*g[0]+g[1]*g[1]),0>=h&&(h=1E-10),Infinity==h&&(h=Number.MAX_VALUE),-Infinity==h&&(h=Number.MIN_VALUE),d.U=r(r(g,h),
10),d.J=q/10):(d.target.attack(d.C),g=K.indexOf(d),-1<g&&K.splice(g,1),g=L.indexOf(d),-1<g&&L.splice(g,1)))}};K.push(d);L.push(d)}var Q,R=0,ya=xa(),za=1/30,S=document.getElementById("a"),I=S.getContext("2d"),X=document.documentElement;Aa();var Ba=S.getBoundingClientRect(),P=null,K=[],L=[];C(-40,0,0,2);C(40,0,1,2);for(var Na=-1;2>Na;Na++)for(var Oa=-1;2>Oa;Oa++)C(20*Na,20*Oa);for(var Y=0;Y<w.length;Y++)for(var Z=0;Z<w.length;Z++)Y!=Z&&30>qa(w[Y].A,w[Z].A)&&w[Y].S.push(w[Z]);
var O=function(a){function b(d,g){document.addEventListener(d,g,!1)}for(var c={key:[200],N:!1,P:!1,M:!1,W:!1,O:[0,0],update:function(){this.P=this.N=!1}},k=0;200>k;k++)c.key[k]=!1;b("keydown",function(d){c.key[d.keyCode]=!0});b("keyup",function(d){c.key[d.keyCode]=!1});b("click",function(){});b("mousedown",function(d){0==d.button&&(c.N=!0,c.M=!0);2==d.button&&(c.P=!0,c.M=!0)});b("mouseup",function(d){0==d.button&&(c.M=!1);2==d.button&&(c.W=!1)});b("mousemove",function(d){c.O[0]=d.clientX-a.left;c.O[1]=
d.clientY-a.top});return c}(Ba);K.push(O);function xa(){var a=window.performance;return a&&a.now?a.now():(new Date).getTime()}function Pa(){I.fillStyle="#101010";I.fillRect(0,0,width,height);null!=P&&P.V(I);L.forEach(function(a){return a.R(I)})}function Qa(){var a=R;O.N&&(P=ua(),va());if(O.P){var b=ua();null!=P&&null!=b&&(P==b?P.upgrade():P.X(b))}K.forEach(function(c){return c.update(a)})}var Ra=requestAnimationFrame;
function Sa(){Q=xa();R=Math.min(1,(Q-ya)/1E3);R>za&&(R=za);ya=Q;Qa();Pa();Ra(Sa);width==X.clientWidth&&height==X.clientHeight||Aa()}Ra(Sa);function Aa(){width=X.clientWidth;height=X.clientHeight;minSize=Math.min(width,height);centerX=.5*width;centerY=.5*height;screenScale=.01*minSize;S.width=width;S.height=height;var a=24;height>width&&(a*=height/width);I.font=parseInt(a)+"pt Arial"}function J(a,b,c,k){I.fillRect(a*screenScale+centerX,b*screenScale+centerY,c*screenScale,k*screenScale)};
</script>
</html>