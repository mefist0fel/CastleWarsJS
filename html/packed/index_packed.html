<html>
	<head>
		<title>Castles</title>
		<style type="text/css">
		body {
			display: block;
			background-color:0;
			width: 100%;
			height: 100%;
			margin: 0;
		}
		canvas {
			background-color:0;
			display: block;
			margin: 0px auto;
		}
		</style>
	</head>
	<body>
		<canvas id="a"></canvas>
	</body>
	<script type="text/javascript">
function ea(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function fa(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if(b)return b.call(a);if("number"==typeof a.length)return{next:ea(a)};throw Error(String(a)+" is not an iterable or ArrayLike");}function ha(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}function ia(a,b){return Math.sqrt((a[0]-b[0])*(a[0]-b[0])+(a[1]-b[1])*(a[1]-b[1]))}
function r(a,b){return[a[0]*b,a[1]*b,a[2]*b]}function u(a,b){w.addEventListener(a,b,!1)}function ja(){this.Y=function(a){for(var b=0;24>b;b++)this[String.fromCharCode(97+b)]=a[b]||0;.01>this.c&&(this.c=.01);a=this.b+this.c+this.e;.18>a&&(a=.18/a,this.b*=a,this.c*=a,this.e*=a)}}
var ka=new function(){this.I=new ja;var a,b,c,f,d,k,q,h,e,p,n,la;this.reset=function(){var l=this.I;f=100/(l.f*l.f+.001);d=100/(l.g*l.g+.001);k=1-l.h*l.h*l.h*.01;q=-l.i*l.i*l.i*1E-6;l.a||(n=.5-l.n/2,la=5E-5*-l.o);h=1+l.l*l.l*(0<l.l?-.9:10);e=0;p=1==l.m?0:(1-l.m)*(1-l.m)*2E4+32};this.$=function(){this.reset();var l=this.I;a=l.b*l.b*1E5;b=l.c*l.c*1E5;c=l.e*l.e*1E5+12;return 3*((a+b+c)/3|0)};this.Z=function(l,ma){var g=this.I,na=1!=g.s||g.v,E=g.v*g.v*.1,oa=1+3E-4*g.w,A=g.s*g.s*g.s*.1,Ka=1+1E-4*g.t,La=
1!=g.s,Ma=g.x*g.x,Na=g.g,pa=g.q||g.r,Oa=g.r*g.r*g.r*.2,qa=g.q*g.q*(0>g.q?-1020:1020),ra=g.p?((1-g.p)*(1-g.p)*2E4|0)+32:0,Pa=g.d,sa=g.j/2,Qa=g.k*g.k*.01,aa=g.a,ba=a,Ra=1/a,Sa=1/b,Ta=1/c;g=5/(1+g.u*g.u*20)*(.01+A);.8<g&&(g=.8);g=1-g;for(var ca=!1,ta=0,H=0,I=0,ua=0,Q=0,J,K=0,t,B=0,C,da=0,m,va=0,F,wa=0,R=Array(1024),L=Array(32),v=R.length;v--;)R[v]=0;for(v=L.length;v--;)L[v]=2*Math.random()-1;for(v=0;v<ma;v++){if(ca)return v;ra&&++va>=ra&&(va=0,this.reset());p&&++e>=p&&(p=0,f*=h);k+=q;f*=k;f>d&&(f=d,
0<Na&&(ca=!0));t=f;0<sa&&(wa+=Qa,t*=1+Math.sin(wa)*sa);t|=0;8>t&&(t=8);aa||(n+=la,0>n?n=0:.5<n&&(n=.5));if(++H>ba)switch(H=0,++ta){case 1:ba=b;break;case 2:ba=c}switch(ta){case 0:I=H*Ra;break;case 1:I=1+2*(1-H*Sa)*Pa;break;case 2:I=1-H*Ta;break;case 3:I=0,ca=!0}pa&&(qa+=Oa,C=qa|0,0>C?C=-C:1023<C&&(C=1023));na&&oa&&(E*=oa,1E-5>E?E=1E-5:.1<E&&(E=.1));F=0;for(var Ua=8;Ua--;){B++;if(B>=t&&(B%=t,3==aa))for(J=L.length;J--;)L[J]=2*Math.random()-1;switch(aa){case 0:m=B/t<n?.5:-.5;break;case 1:m=1-B/t*2;break;
case 2:m=B/t;m=6.28318531*(.5<m?m-1:m);m=1.27323954*m+.405284735*m*m*(0>m?1:-1);m=.225*((0>m?-1:1)*m*m-m)+m;break;case 3:m=L[Math.abs(32*B/t|0)]}na&&(J=K,A*=Ka,0>A?A=0:.1<A&&(A=.1),La?(Q+=(m-K)*A,Q*=g):(K=m,Q=0),K+=Q,ua+=K-J,m=ua*=1-E);pa&&(R[da%1024]=m,m+=R[(da-C+1024)%1024],da++);F+=m}F*=.125*I*Ma;l[v]=1<=F?32767:-1>=F?-32768:32767*F|0}return ma}};
window.jsfxr=function(a){ka.I.Y(a);var b=ka.$();a=new Uint8Array(4*((b+1)/2|0)+44);b=2*ka.Z(new Uint16Array(a.buffer,44),b);var c=new Uint32Array(a.buffer,0,44);c[0]=1179011410;c[1]=b+36;c[2]=1163280727;c[3]=544501094;c[4]=16;c[5]=65537;c[6]=44100;c[7]=88200;c[8]=1048578;c[9]=1635017060;c[10]=b;b+=44;c=0;for(var f="data:audio/wav;base64,";c<b;c+=3){var d=a[c]<<16|a[c+1]<<8|a[c+2];f+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>18]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>
12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d&63]}return f};var x=[];
function xa(a,b,c,f){var d=[1,2,3],k=[1,2,3],q=[15,20,999],h={A:[a,b],C:void 0===c?-1:c,L:0,T:null,target:null,level:void 0===f?0:f,B:10,max:100,K:1,H:0,S:[],G:0,F:null,R:function(){y.fillStyle=ya(h.C);var e=d[this.level];z(h.A[0]-e,h.A[1]-e,e+e,e+e);y.textAlign="center";y.fillText(h.B,h.A[0]*D+G,(h.A[1]-e-1)*D+M);h.B>=q[h.level]&&z(h.A[0]+e+e,h.A[1]-e-e-1,1,1)},V:function(){y.fillStyle="#FFFFFF";var e=d[this.level]+1;z(h.A[0]-e,h.A[1]-e,e+e,e+e);y.fillStyle="#FF00FF";x.forEach(function(p){if(null!=
p.F){var n=d[p.level]+1;z(p.A[0]-n,p.A[1]-n,n+n,n+n)}})},upgrade:function(){this.B>=q[h.level]&&(this.B-=q[h.level],this.level+=1)},update:function(e){this.K-=e;0>=this.K&&(this.K=1,0<=this.C&&h.B<h.max&&(this.B+=k[this.level]));0<this.H?this.H-=e:0<this.B&&0<this.L?(--this.B,--this.L,za(this.A[0],this.A[1],this.C,this.T),this.H+=.2):this.target=null},contains:function(e,p){var n=h.A;return n[0]-3<e&&n[1]-3<p&&n[0]+3>e&&n[1]+3>p},attack:function(e){this.C==e?this.B+=1:0>=this.B?(this.C=e,this.B=1):
--this.B},X:function(e){if(null!=e&&null!=e.F){this.target=e;this.L=this.B/2;var p=[];for(p.push(e);null!=e.F;)e=e.F,p.push(e);this.T=p}}};N.push(h);O.push(h);x.push(h)}function ya(a){switch(a){case 0:return"#0000FF";case 1:return"#FF0000";case 2:return"#00FF00";default:return"#555555"}}function Aa(){var a=P.O,b=(a[0]-G)/D;a=(a[1]-M)/D;for(var c=0;c<x.length;c++)if(x[c].contains(b,a))return x[c];return null}
function Ba(){var a=S;x.forEach(function(f){f.G=99999;f.F=null});if(null!=a){var b=[];b.push(a);a.G=0;for(var c={};0<b.length;)c={D:c.D},c.D=b.pop(),c.D.S.forEach(function(f){return function(d){var k=f.D.G+ia(f.D.A,d.A);d.G>k&&(d.G=k,d.F=f.D,d.C==a.C&&b.push(d))}}(c))}}var Ca=[0,0];
function za(a,b,c,f){var d={A:[a,b],U:Ca,J:0,C:c,target:null,path:[].concat(f instanceof Array?f:ha(fa(f))),B:1,R:function(k){k.fillStyle=ya(d.C);z(d.A[0]-1,d.A[1]-1,2,2)},update:function(k){var q=d.A,h=r(d.U,k);d.A=[q[0]+h[0],q[1]+h[1]];d.J-=k;0>=d.J&&(0<d.path.length?(d.target=d.path.pop(),k=d.target.A,q=d.A,k=[k[0]-q[0],k[1]-q[1]],q=Math.sqrt(k[0]*k[0]+k[1]*k[1]),h=1/Math.sqrt(k[0]*k[0]+k[1]*k[1]),0>=h&&(h=1E-10),Infinity==h&&(h=Number.MAX_VALUE),-Infinity==h&&(h=Number.MIN_VALUE),d.U=r(r(k,h),
10),d.J=q/10):(d.target.attack(d.C),k=N.indexOf(d),-1<k&&N.splice(k,1),k=O.indexOf(d),-1<k&&O.splice(k,1)))}};N.push(d);O.push(d)}var Da,T=0,Fa=Ea(),Ga=1/30,w=document,U=w.getElementById("a"),y=U.getContext("2d"),V=1,W=1,Ha=1,G=1,M=1,D=1,X=w.documentElement;Ia();var Ja=U.getBoundingClientRect(),S=null,N=[],O=[];xa(-40,0,0,2);xa(40,0,1,2);for(var Va=-1;2>Va;Va++)for(var Wa=-1;2>Wa;Wa++)xa(20*Va,20*Wa);for(var Y=0;Y<x.length;Y++)for(var Z=0;Z<x.length;Z++)Y!=Z&&30>ia(x[Y].A,x[Z].A)&&x[Y].S.push(x[Z]);
var P=function(a){for(var b={key:[200],N:!1,P:!1,M:!1,W:!1,O:[0,0],update:function(){this.P=this.N=!1}},c=0;200>c;c++)b.key[c]=!1;u("keydown",function(f){b.key[f.keyCode]=!0});u("keyup",function(f){b.key[f.keyCode]=!1});u("click",function(){});u("mousedown",function(f){0==f.button&&(b.N=!0,b.M=!0);2==f.button&&(b.P=!0,b.M=!0)});u("mouseup",function(f){0==f.button&&(b.M=!1);2==f.button&&(b.W=!1)});u("mousemove",function(f){b.O[0]=f.clientX-a.left;b.O[1]=f.clientY-a.top});return b}(Ja);N.push(P);
function Ea(){var a=window.performance;return a&&a.now?a.now():(new Date).getTime()}function Xa(){y.fillStyle="#101010";y.fillRect(0,0,V,W);null!=S&&S.V(y);O.forEach(function(a){return a.R(y)})}function Ya(){var a=T;P.N&&(S=Aa(),Ba());if(P.P){var b=Aa();null!=S&&null!=b&&(S==b?S.upgrade():S.X(b))}N.forEach(c => c.update(a))}var Za=requestAnimationFrame;function $a(){Da=Ea();T=Math.min(1,(Da-Fa)/1E3);T>Ga&&(T=Ga);Fa=Da;Ya();Xa();Za($a);V==X.clientWidth&&W==X.clientHeight||Ia()}Za($a);
function Ia(){V=X.clientWidth;W=X.clientHeight;Ha=Math.min(V,W);G=.5*V;M=.5*W;D=.01*Ha;U.width=V;U.height=W;var a=24;W>V&&(a*=W/V);y.font=parseInt(a)+"pt Arial"}function z(a,b,c,f){y.fillRect(a*D+G,b*D+M,c*D,f*D)};
</script>
</html>